<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<title>bg.dbpedia.org started</title>
<meta name="author" content="(Vladimir Alexiev)"/>

<link rel="stylesheet" href="../../reveal.js/css/reveal.min.css"/>
<link rel="stylesheet" href="../../reveal.js/css/theme/solarized.css" id="theme"/>

<!-- If the query includes 'print-pdf', include the PDF print sheet -->
<script>
    if( window.location.search.match( /print-pdf/gi ) ) {
        var link = document.createElement( 'link' );
        link.rel = 'stylesheet';
        link.type = 'text/css';
        link.href = '../../reveal.js/css/print/pdf.css';
        document.getElementsByTagName( 'head' )[0].appendChild( link );
    }
</script>

<style type="text/css">
h1,h2,h3,h4,h5,h6,h7 {font-family: Arial}
// don't want empty lines in auto-postamble
.author, .date, .creator {-webkit-margin-before: 0em; -webkit-margin-after: 0em}
// style for #+begin_abstract
.abstract {margin: 1em; padding: 1em; border: 1px solid black}
.abstract:before {content: "Abstract: "; font-weight: bold}
// center the preamble (author name) and make it bigger
#preamble p { font-size: 110%; margin-left: auto; margin-right: auto; text-align: center; }
// table headers aligned same as table data
th.left     {text-align:left}
th.right    {text-align:right}
// table horizontal&vertical borders. First value is top&bottom, second is left&right. http://www.w3schools.com/css/css_border.asp
th, td {border-width: 1px; border-style: solid solid; border-spacing: 2px 2px; padding:4px 2px}
// colored TODO keywords
.CANCELED   {color: blue}
.MAYBE      {color: blue}
.POSTPONED  {color: blue}
.INPROGRESS {color: orange}
.NEXT       {color: orange}
.IER        {color: orange}
</style>

<style>
.reveal .slides {text-align:left}
h1,h2,h3,h4,h5,h6,.center {text-align:center}
img,table {display: block; margin-left:auto!important; margin-right:auto!important}
td>img {width:250px; display:block; margin-left:auto!important; margin-right:auto!important; margin-top:0px!important; margin-bottom:0px!important}
.reveal th, .reveal td {font-size:80%; border: 1px; border-style: solid solid; border-spacing:0; padding:0px 2px}
span.clouditem {padding-left: 0.15em; padding-right: 0.15em; line-height: 90%}
#table-of-contents {font-size:70%}
</style>
</head>
<body>
<div class="reveal">
<div class="slides">
<section>
<h1>bg.dbpedia.org started</h1><h2>Vladimir Alexiev</h2><h2><a href="mailto:vladimir.alexiev@ontotext.com">vladimir.alexiev@ontotext.com</a></h2><h2></h2>
<p class='center'>
This is a 2D interactive presentation. 
Press <a href='javascript:Reveal.toggleOverview()'>O for overview</a>, 
<a href='../../reveal.js/js/reveal-help.html' target='_blank'>H for help</a>.</p>
<p class='center'>
Proudly made in plain text with 
<a href='https://github.com/hakimel/reveal.js/'>reveal.js</a>, 
<a href='https://github.com/yjwen/org-reveal'>org-reveal</a>, 
<a href='http://orgmode.org'>org-mode</a> and 
<a href='http://www.gnu.org/s/emacs/'>emacs</a>.</p></section>
<section id="table-of-contents">
<h2>Table of Contents</h2><ul>
<li>
<a href="#/sec-1">bg.dbpedia: Home Page</a>
<ul>
<li>
<a href="#/sec-1-1">Search With Autocomplete</a>
</li>
<li>
<a href="#/sec-1-2">Resource Page (Vassil Levski)</a>
</li>
</ul>
<li>
<a href="#/sec-2">Sample Queries</a>
</li>
<li>
<a href="#/sec-3">Pages without type</a>
</li>
<li>
<a href="#/sec-4">Page Stats</a>
</li>
<li>
<a href="#/sec-5">Settlements</a>
<ul>
<li>
<a href="#/sec-5-1">Wrong Data</a>
</li>
<li>
<a href="#/sec-5-2">Place Parents</a>
</li>
<li>
<a href="#/sec-5-3">Places With Biggest Population</a>
</li>
</ul>
<li>
<a href="#/sec-6">Musical Artists</a>
<ul>
<li>
<a href="#/sec-6-1">ConditionalMapping</a>
</li>
<li>
<a href="#/sec-6-2">Data Improvement</a>
</li>
</ul>
<li>
<a href="#/sec-7">Musical Genres</a>
<ul>
<li>
<a href="#/sec-7-1">Popular Genres</a>
</li>
<li>
<a href="#/sec-7-2">Making Charts</a>
</li>
</ul>
</section>

<section id="sec-1" >

<h2><span class="section-number-2">1</span> bg.dbpedia: Home Page</h2>
<img src="./img/bg-home-page.png" alt="bg-home-page.png" />
</section>
<section>
<section id="sec-1-1" >

<h3><span class="section-number-3">1.1</span> Search With Autocomplete</h3>
<img src="./img/bg-search.png" alt="bg-search.png" />
</section>
</section>
<section>
<section id="sec-1-2" >

<h3><span class="section-number-3">1.2</span> Resource Page (Vassil Levski)</h3>
<img src="./img/bg-resource-Levski.png" alt="bg-resource-Levski.png" />
</section>
</section>
<section id="sec-2" >

<h2><span class="section-number-2">2</span> Sample Queries</h2>
<p>
Брой факти
</p>
<div class="org-src-container">

<pre  class="src src-SPARQL">select (count(*) as ?c) {?s ?p ?o}
</pre>
</div>
<p>
Брой страници
</p>
<div class="org-src-container">

<pre  class="src src-SPARQL">select (count(*) as ?c) {?thing <span style="color: #228b22;">foaf:</span><span style="color: #008b8b;">isPrimaryTopicOf</span> ?page}
</pre>
</div>
<p>
Брой хора
</p>
<div class="org-src-container">

<pre  class="src src-SPARQL">select (count(*) as ?c) {?person <span style="color: #a020f0;">a</span> <span style="color: #228b22;">dbo:</span>Person}
</pre>
</div>
<p>
Брой организации
</p>
<div class="org-src-container">

<pre  class="src src-SPARQL">select (count(*) as ?c) {?org <span style="color: #a020f0;">a</span> <span style="color: #228b22;">dbo:</span>Organisation}
</pre>
</div>
<p>
Брой места
</p>
<div class="org-src-container">

<pre  class="src src-SPARQL">select (count(*) as ?c) {?place <span style="color: #a020f0;">a</span> <span style="color: #228b22;">dbo:</span>Place}
</pre>
</div>
<p>
Брой растения/животни
</p>
<div class="org-src-container">

<pre  class="src src-SPARQL">select (count(*) as ?c) {?place <span style="color: #a020f0;">a</span> <span style="color: #228b22;">dbo:</span>Species}
</pre>
</div>
<p>
Брой произведения
</p>
<div class="org-src-container">

<pre  class="src src-SPARQL">select (count(*) as ?c) {?place <span style="color: #a020f0;">a</span> <span style="color: #228b22;">dbo:</span>Work}
</pre>
</div>
</section>
<section id="sec-3" >

<h2><span class="section-number-2">3</span> Pages without type</h2>
<p>
Брой страници без тип
</p>
<div class="org-src-container">

<pre  class="src src-SPARQL">select (count(*) as ?c) {
  ?thing <span style="color: #228b22;">foaf:</span><span style="color: #008b8b;">isPrimaryTopicOf</span> ?page.
  filter not exists{?thing <span style="color: #a020f0;">a</span> ?type.
    filter (?type in <span style="color: #228b22;">(owl:Thing,dbo:Place,dbo:</span>Species))}}
</pre>
</div>
<p>
Страници без тип: с техните категории
</p>
<div class="org-src-container">

<pre  class="src src-SPARQL">select ?thing (group_concat(?cat;separator=<span style="color: #8b2252;">"; "</span>) as ?cats) {
  ?thing <span style="color: #228b22;">foaf:</span><span style="color: #008b8b;">isPrimaryTopicOf</span> ?page.
  filter not exists{?thing <span style="color: #a020f0;">a</span> ?type.
    filter (?type in <span style="color: #228b22;">(owl:Thing,dbo:Place,dbo:</span>Species))}
  ?thing <span style="color: #228b22;">dct:</span><span style="color: #008b8b;">subject</span> ?category.
  <span style="color: #228b22;">bind(strafter(str(?category),</span><span style="color: #8b2252;">"http://bg.dbpedia.org/resource/Категория:"</span><span style="color: #008b8b;">)</span> as ?cat)
} group by ?thing
</pre>
</div>
</section>
<section id="sec-4" >

<h2><span class="section-number-2">4</span> Page Stats</h2>
<p>
Най-големи страници
</p>
<div class="org-src-container">

<pre  class="src src-SPARQL">select * {
  ?x <span style="color: #228b22;">dbo:</span><span style="color: #008b8b;">wikiPageLength</span> ?len
} order by desc(?len) limit 100
</pre>
</div>
<p>
Страници с най-много линкове
</p>
<div class="org-src-container">

<pre  class="src src-SPARQL">select ?x (count(*) as ?links) {
  ?x <span style="color: #228b22;">dbo:</span><span style="color: #008b8b;">wikiPageWikiLink</span> ?l
} group by ?x order by desc(?links) limit 100
</pre>
</div>
</section>
<section id="sec-5" >

<h2><span class="section-number-2">5</span> Settlements</h2>
<p>
Най-големи нас.места:
</p>
<div class="org-src-container">

<pre  class="src src-SPARQL">PREFIX <span style="color: #228b22;">bgdbp:</span><span style="color: #008b8b;"> </span><span style="color: #0000ff;"><http://bg.dbpedia.org/property/></span>
PREFIX <span style="color: #228b22;">dbo:</span><span style="color: #008b8b;"> </span><span style="color: #0000ff;"><http://dbpedia.org/ontology/></span>
select ?x ?are<span style="color: #a020f0;">a</span> {
  ?x <span style="color: #228b22;">bgdbp:</span><span style="color: #008b8b;">wikiPageUsesTemplate</span> <span style="color: #0000ff;"><http://bg.dbpedia.org/resource/Шаблон:Селище_в_България></span>;
     <span style="color: #228b22;">dbo:</span><span style="color: #008b8b;">areaLand</span> ?are<span style="color: #a020f0;">a</span>
} order by desc(?are<span style="color: #a020f0;">a</span>) limit 100
</pre>
</div>
</section>
<section>
<section id="sec-5-1" >

<h3><span class="section-number-3">5.1</span> Wrong Data</h3>
<ul class="org-ul">
<li>Най-големите НМ са Мътеница, Дебелец, Дъбовик, Ръжево, Мало Крушево?!?
<ul class="org-ul">
<li><a href="https://bg.wikipedia.org/wiki/Мътеница_(село)">https://bg.wikipedia.org/wiki/Мътеница_(село)</a>:
<pre class="example">
Землище    33 035 km²
</pre>
</li>
<li><a href="https://bg.wikipedia.org/w/index.php?title=Мътеница_(село)&action=edit">https://bg.wikipedia.org/w/index.php?title=Мътеница_(село)&action=edit</a>
<pre class="example">
| площ = 33 035
</pre>
</li>
<li>Това е 1/3 от площта на България ;-)
</li>
<li>Ние приемаме, че "," и "." са десетичен знак, ама чак пък интервал…
</li>
<li>На друго място съм виждал изписано така: <code>1 nbsp;234</code>, което се извлича като "1" :-(
</li>
</ul>
</li>
<li>Ако изключим тези грешки, следващото НМ е София
</li>
<li>После е Батак?
<ul class="org-ul">
<li><a href="https://bg.wikipedia.org/wiki/Батак">https://bg.wikipedia.org/wiki/Батак</a>: Землище 461.105 km²: не ми се вярва
</li>
<li>Спас Колев казва, че е вярно. Това е землището на града (не само градската територия), и Батак включва голяма планинска територия.
</li>
<li>Надм. височина 1036m? Но Екатте дава интервал Надм. височина, м: 700 - 999 вкл <a href="http://www.ekatte.com/област-пазарджик/община-батак/батак">http://www.ekatte.com/област-пазарджик/община-батак/батак</a>
</li>
</ul>
</li>
</ul>
</section>
</section>
<section>
<section id="sec-5-2" >

<h3><span class="section-number-3">5.2</span> Place Parents</h3>
<ul class="org-ul">
<li>Няма структурно поле, което да индицира Settlements само в Bulgaria.
</li>
</ul>
<p>
В момента информацията за административната структура на местата (и броят население) не може да се извлече
</p>
<ul class="org-ul">
<li>Причина: в bg.wikipedia, голяма част от информацията е заключена в lookup lists in sub-templates, като "ekatte" се ползва за ключ.
</li>
<li>Напр за Мътеница <a href="https://bg.wikipedia.org/w/index.php?title=Мътеница_(село)&action=edit">https://bg.wikipedia.org/w/index.php?title=Мътеница_(село)&action=edit</a>:
<pre class="example">
{{Селище в България
| екатте = 49624
| надм-височина=441 ...
</pre>
</li>
<li>Извън шаблона (в свободен текст) се казва: "<i>село</i> в <i>Южна България</i>. То се намира в <i>община Хисаря</i>, <i>Област Пловдив</i>".
Тези се извличат като линкове, но не в структурни полета.
</li>
<li>The extraction framework cannot extract data from such lists. See issue <a href="https://github.com/dbpedia/extraction-framework/issues/305">#305</a>: resolving lookup-list data out of sub-templates
</li>
</ul>
</section>
</section>
<section>
<section id="sec-5-3" >

<h3><span class="section-number-3">5.3</span> Places With Biggest Population</h3>
<p>
Населени места с най-голямо население
</p>
<div class="org-src-container">

<pre  class="src src-SPARQL">PREFIX <span style="color: #228b22;">bgdbp:</span><span style="color: #008b8b;"> </span><span style="color: #0000ff;"><http://bg.dbpedia.org/property/></span>
PREFIX <span style="color: #228b22;">dbo:</span><span style="color: #008b8b;"> </span><span style="color: #0000ff;"><http://dbpedia.org/ontology/></span>
select * {
  ?x <span style="color: #228b22;">bgdbp:</span><span style="color: #008b8b;">wikiPageUsesTemplate</span> <span style="color: #0000ff;"><http://bg.dbpedia.org/resource/Шаблон:Селище_в_България></span>;
     <span style="color: #228b22;">dbo:</span><span style="color: #008b8b;">populationTotal</span> ?pop
} order by desc(?pop) limit 100
</pre>
</div>
<p>
Ура! Тези май са верни :-)
</p>
</section>
</section>
<section id="sec-6" >

<h2><span class="section-number-2">6</span> Musical Artists</h2>
<p>
Музикални изпълнители и групи
</p>
<div class="org-src-container">

<pre  class="src src-SPARQL">PREFIX <span style="color: #228b22;">dbo:</span><span style="color: #008b8b;"> </span><span style="color: #0000ff;"><http://dbpedia.org/ontology/></span>
select * {
  ?x <span style="color: #a020f0;">a</span> ?type
  filter (?type in <span style="color: #228b22;">(dbo:</span><span style="color: #008b8b;">MusicalArtist,</span> <span style="color: #228b22;">dbo:</span>Band))
}
</pre>
</div>
<ul class="org-ul">
<li>2559. Но само 111 са dbo:MusicalArtist?!? Напр. Лили Иванова и Горан Брегович излизат като dbo:Band (и оттам dbo:Organisation ;-))
</li>
<li>Причината е, че мапингът <a href="http://mappings.dbpedia.org/index.php?title=Mapping_bg:Музикален_изпълнител&action=edit&oldid=18009">Музикален_изпълнител имаше следният проблем</a>:  
<pre class="example">
{{ Condition
  | templateProperty = фон
  | operator = isSet
  | mapping = {{ TemplateMapping | mapToClass = Band }}
}}
</pre>
</li>
<li>Т.е. ако има поле "фон", то приеми че е Група. Напр. Горан Брегович: фон = инструменталист
</li>
</ul>
</section>
<section>
<section id="sec-6-1" >

<h3><span class="section-number-3">6.1</span> ConditionalMapping</h3>
<p>
Сега го оправихме <a href="http://mappings.dbpedia.org/index.php?title=Mapping_bg:Музикален_изпълнител&action=edit">да има следната сложна логика</a>: 
</p>
<ul class="org-ul">
<li>Ако има поле "състав", "бивши_членове" или "създадена" -> Band
<ul class="org-ul">
<li>(Ами "членове"? Не знам)
</li>
</ul>
</li>
<li>Ако "фон" съдържа "група", "квартет", "ансамбъл", "хор" -> Band
</li>
<li>Ако "фон" съдържа "композитор" -> MusicComposer
</li>
<li>Ако "фон" съдържа "диригент" -> MusicDirector
</li>
<li>Ако "фон" съдържа "певица" -> MusicalArtist, gender=dbo:Female
</li>
<li>Ако "фон" съдържа "певец" -> MusicalArtist, gender=dbo:Male
</li>
<li>Ако "фон" съдържа "пианист" -> MusicalArtist, gender=dbo:Male
</li>
<li>Ако има поле "наставка" -> MusicalArtist, gender=dbo:Female
</li>
<li>Иначе -> MusicalArtist, gender=dbo:Male
</li>
</ul>
</section>
</section>
<section>
<section id="sec-6-2" >

<h3><span class="section-number-3">6.2</span> Data Improvement</h3>
<ul class="org-ul">
<li>Вече Лили Иванова не е Band (и Organisation), а MusicalArtist, gender=dbo:Female. Ура!
<ul class="org-ul">
<li>Макар че някои биха оспорили, че де-факто тя е <b>институция</b> в българската музика
</li>
</ul>
</li>
<li>По принцип шаблонът <a href="https://bg.wikipedia.org/wiki/Шаблон:Музикален_изпълнител">https://bg.wikipedia.org/wiki/Шаблон:Музикален_изпълнител</a> казва, че "фон" трябва да е: певец, инструменталист, не_изпълнител, временно.
<ul class="org-ul">
<li>Но има мноого изключения, напр. "фолк певица" (е може ли без нея)
</li>
<li>Нашият мапинг следва реалните данни
</li>
</ul>
</li>
<li>Тригонометрична_функция и България_на_Световното_първенство_по_футбол_1994?!?
<ul class="org-ul">
<li>Преди ползваха шаблон "Музикален изпълнител"
</li>
<li>Но вече не, напр <a href="https://bg.wikipedia.org/w/index.php?title=Тригонометрична_функция&diff=6434190&oldid=5927191">https://bg.wikipedia.org/w/index.php?title=Тригонометрична_функция&diff=6434190&oldid=5927191</a>
</li>
<li>При следващото извличане ще се актуализират и ще отпаднат от този списък
</li>
</ul>
</li>
</ul>
</section>
</section>
<section id="sec-7" >

<h2><span class="section-number-2">7</span> Musical Genres</h2>
<p>
Музикални изпълнители за които са посочени жанрове
</p>
<div class="org-src-container">

<pre  class="src src-SPARQL">PREFIX <span style="color: #228b22;">dbo:</span><span style="color: #008b8b;"> </span><span style="color: #0000ff;"><http://dbpedia.org/ontology/></span>
select ?x (group_concat(?genre;separator=<span style="color: #8b2252;">"; "</span>) as ?genres) {
  ?x <span style="color: #a020f0;">a</span> ?type. filter (?type in <span style="color: #228b22;">(dbo:</span><span style="color: #008b8b;">MusicalArtist,</span> <span style="color: #228b22;">dbo:</span>Band))
  ?x <span style="color: #228b22;">dbo:</span><span style="color: #008b8b;">genre</span> ?g.
   bind <span style="color: #228b22;">(strafter(str(?g),</span><span style="color: #8b2252;">"http://bg.dbpedia.org/resource/"</span>) as ?genre)
} group by ?x
</pre>
</div>
</section>
<section>
<section id="sec-7-1" >

<h3><span class="section-number-3">7.1</span> Popular Genres</h3>
<p>
Музикални жанрове по популярност
</p>
<div class="org-src-container">

<pre  class="src src-SPARQL">PREFIX <span style="color: #228b22;">dbo:</span><span style="color: #008b8b;"> </span><span style="color: #0000ff;"><http://dbpedia.org/ontology/></span>
select ?genre (count(*) as ?c) {
  ?x <span style="color: #a020f0;">a</span> ?type. filter (?type in <span style="color: #228b22;">(dbo:</span><span style="color: #008b8b;">MusicalArtist,</span> <span style="color: #228b22;">dbo:</span>Band))
  ?x <span style="color: #228b22;">dbo:</span><span style="color: #008b8b;">genre</span> ?g.
  bind <span style="color: #228b22;">(strafter(str(?g),</span><span style="color: #8b2252;">"http://bg.dbpedia.org/resource/"</span>) as ?genre)
} group by ?genre order by desc(?c) limit 20
</pre>
</div>
<ul class="org-ul">
<li>520 жанра
</li>
<li>Най-популярните са
<pre class="example">
Поп_музика      356  (изненада!
Хард_рок        313
Хеви_метъл      238
</pre>
</li>
</ul>
</section>
</section>
<section>
<section id="sec-7-2" >

<h3><span class="section-number-3">7.2</span> Making Charts</h3>
<ul class="org-ul">
<li>Charts directly from SPARQL: <a href="http://goo.gl/l3lAeB">VISU</a>, <a href="http://jsfiddle.net/valexiev/1p9qs2zu/">sgvizler</a> (jsfiddle)
</li>
<li>Or Query> Save as> TSV and make it in Excel
</li>
</ul>
<img src="./img/музикални-жанрове.png" alt="музикални-жанрове.png" />
</section>
</section>
</div>
</div>

<script src="../../reveal.js/lib/js/head.min.js"></script>
<script src="../../reveal.js/js/reveal.min.js"></script>

<script>
// Full list of configuration options available here:
// https://github.com/hakimel/reveal.js#configuration
Reveal.initialize({

controls: true,
progress: true,
history: true,
center: true,
slideNumber: true,
rollingLinks: false,
keyboard: true,
overview: true,
width: 1200,
height: 925,

theme: Reveal.getQueryHash().theme, // available themes are in /css/theme
transition: Reveal.getQueryHash().transition || 'none', // default/cube/page/concave/zoom/linear/fade/none
transitionSpeed: 'default',

// Optional libraries used to extend on reveal.js
dependencies: [
{src: '../../reveal.js/js/reveal-help.js', async: true, condition: function() {return !!document.body.classList}}, {src: 'js/reveal-tagcloud.js', async: true, condition: function() {return !!document.body.classList}},
 { src: '../../reveal.js/lib/js/classList.js', condition: function() { return !document.body.classList; } },
 { src: '../../reveal.js/plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
 { src: '../../reveal.js/plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
 { src: '../../reveal.js/plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
 { src: '../../reveal.js/plugin/zoom-js/zoom.js', async: true, condition: function() { return !!document.body.classList; } },
 { src: '../../reveal.js/plugin/notes/notes.js', async: true, condition: function() { return !!document.body.classList; } }
]
});
</script>
</body>
</html>
